<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Verificador PRISMA</title>
    <style>
        #loading {
            display: none;
            margin-top: 20px;
            font-weight: bold;
            color: #333;
        }
        .spinner {
            margin-top: 10px;
            width: 40px;
            height: 40px;
            border: 5px solid #ccc;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
<h2>Verificador com Metodologia PRISMA</h2>

<form method="post" enctype="multipart/form-data" onsubmit="mostrarSpinner()">
    <label>Arquivo Excel:</label>
    <input type="file" name="arquivo" accept=".xlsx" required><br><br>

    <label>Palavras-chave (separadas por vírgulas):</label><br>
    <input type="text" name="termos" size="80" required><br><br>

    <button type="submit">Processar</button>
</form>

<div id="loading">
    ⏳ Processando... por favor, aguarde.
    <div class="spinner"></div>
</div>

<hr>
<h3>Downloads:</h3>
<ul>
    {% for arq in arquivos %}
    <li><a href="{{ url_for('download', filename=arq) }}">{{ arq }}</a></li>
    {% endfor %}
</ul>

<script>
    function mostrarSpinner() {
        document.getElementById("loading").style.display = "block";
    }
</script>
</body>
</html>
